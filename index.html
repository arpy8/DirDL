<!doctypehtml><html lang=en><meta charset=UTF-8><meta content="width=device-width,initial-scale=1"name=viewport><title>Github Directory Downloader</title><style>#input-field,.container{width:100%;border:1px solid #333}#input-field,body{background:#0a0a0a;color:#fff}.container,button{background:#1a1a1a}#input-field,#log{padding:12px 16px}#log,body{display:flex}.log-error,.log-success,body,button,h1{color:#fff}*{margin:0;padding:0;box-sizing:border-box}body{font-family:"Segoe UI",Tahoma,Geneva,Verdana,sans-serif;min-height:100vh;flex-direction:column;justify-content:center;align-items:center;padding:20px}.container{border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,.5);padding:32px;max-width:500px;text-align:center}h1{margin-bottom:24px;font-size:1.8rem;font-weight:600}.input-container{position:relative;margin-bottom:12px}#input-field{font-size:14px;border-radius:8px;transition:.2s}#log,button{font-size:13px;transition:.2s}#clear-btn,#reload,.log-success,button:hover{border-color:#666}#input-field:focus{outline:0;border-color:#fff;box-shadow:0 0 0 2px rgba(255,255,255,.1)}#input-field::placeholder{color:#666}.button-group{display:flex;gap:8px;margin-bottom:24px;flex-wrap:wrap}button{flex:1;min-width:120px;padding:10px 16px;font-weight:500;border:1px solid #333;border-radius:6px;cursor:pointer}button:hover{background:#333}#clear-btn,.log-success,button:active{background:#0a0a0a}button:disabled{opacity:.5;cursor:not-allowed}#clear-btn:hover,#reload:hover{background:#333;border-color:#fff}#download-btn:hover{background:#fff;color:#0a0a0a;border-color:#fff}.status-area{margin-top:12px}#log{border-radius:6px;font-weight:400;min-height:44px;align-items:flex-start;justify-content:flex-start;text-align:left;border:1px solid #333}.log-error{background:#1a1a1a;border-color:#999}.log-info{background:#1a1a1a;color:#ccc;border-color:#333}.log-default{background:#0a0a0a;color:#999;border-color:#333}@media (max-width:600px){.button-group{flex-direction:column}button{min-width:unset}.container{padding:24px}}</style><link href=https://www.svgrepo.com/show/499788/download.svg rel=icon type=image/x-icon><div class=container><h1>Github Directory Downloader</h1><div class=input-container><input id=input-field placeholder=https://github.com/arpy8/PastFm></div><div class=button-group><button id=download-btn type=button>Download</button> <button id=reload type=button>Reset Token</button></div><div class=status-area><div class=log-default id=log>Status: Ready</div></div></div><script>let DIR_DL_TOKEN=localStorage.getItem("DIR_DL_TOKEN")||null,logs=[],isTokenValid=!1;for(;!isTokenValid&&!DIR_DL_TOKEN;){let e=window.prompt("Enter GitHub Token:");!e||e.length<=10?alert("Invalid token. Please enter a valid GitHub token."):(DIR_DL_TOKEN=e,localStorage.setItem("DIR_DL_TOKEN",DIR_DL_TOKEN),isTokenValid=!0)}const logElement=document.querySelector("#log"),reloadBtn=document.querySelector("#reload"),inputField=document.querySelector("#input-field"),downloadBtn=document.querySelector("#download-btn");function log(e,t="info"){logElement.className=`log-${t}`,logs.push(`[${new Date().toLocaleString()}] ${e}`),logElement.innerHTML=logs.join("<br>")}async function downloadContent(){let e=inputField.value.trim();if(!e){log("Please enter a GitHub repository or directory URL","error");return}try{log("Parsing URL","info");let{owner:t,repo:o,path:n,isRepo:i}=parseGitHubUrl(e);log("Fetching directory contents","info"),downloadBtn.disabled=!0;let r=await fetchDirectoryContents(t,o,n);if(0===r.length){log("No files found in the directory","error");return}log(`Found ${r.length} files. Creating ZIP`,"info");let l=i?o:`${o}-${n.split("/").pop()||"root"}`;await createAndDownloadZip(r,l,t,o),log("Download completed successfully!","success")}catch(a){console.error("Download failed:",a),log(`Download failed: ${a.message}`,"error")}finally{downloadBtn.disabled=!1}}function parseGitHubUrl(e){e=e.replace(/\/$/,"");let t=e.match(/github\.com\/([^\/]+)\/([^\/]+)$/);if(t){let[,o,n]=t;return{owner:o,repo:n,path:"",isRepo:!0}}let i=e.match(/github\.com\/([^\/]+)\/([^\/]+)\/tree\/[^\/]+\/?(.*)/);if(i){let[,r,l,a]=i;return{owner:r,repo:l,path:a||"",isRepo:!1}}throw Error("Invalid GitHub URL. Please enter a repository URL (github.com/owner/repo) or directory URL (github.com/owner/repo/tree/branch/path)")}async function fetchDirectoryContents(e,t,o,n=[]){let i=`https://api.github.com/repos/${e}/${t}/contents/${o}`,r=await fetch(i,{headers:{Authorization:`Bearer ${DIR_DL_TOKEN}`,Accept:"application/vnd.github.v3+json"}});if(!r.ok){if(401===r.status)throw Error("Invalid GitHub token or insufficient permissions");if(404===r.status)throw Error("Repository or directory not found");throw Error(`GitHub API error: ${r.status} - ${r.statusText}`)}let l=await r.json();for(let a of l)"file"===a.type?n.push({path:a.path,sha:a.sha,name:a.name,size:a.size}):"dir"===a.type&&await fetchDirectoryContents(e,t,a.path,n);return n}async function createAndDownloadZip(e,t,o,n){if("undefined"==typeof JSZip){let i=document.createElement("script");i.src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js",document.head.appendChild(i),await new Promise((e,t)=>{i.onload=e,i.onerror=()=>t(Error("Failed to load JSZip library"))})}try{let r=new JSZip,l=0,a=e.length,s=0;for(let c of e)try{log(`Downloading ${c.name} (${l+1}/${a})`,"info");let d=`https://api.github.com/repos/${o}/${n}/contents/${c.path}`,p=await fetch(d,{headers:{Authorization:`Bearer ${DIR_DL_TOKEN}`,Accept:"application/vnd.github.v3+json"}});if(!p.ok)throw Error(`Failed to fetch ${c.name}: ${p.status}`);let h=await p.json();if(h.content){let u=atob(h.content.replace(/\n/g,"")),f=new Uint8Array(u.length);for(let g=0;g<u.length;g++)f[g]=u.charCodeAt(g);r.file(c.path,f),s++}else console.warn(`No content found for ${c.name}`);l++}catch(w){console.warn(`Failed to download ${c.name}:`,w)}if(0===s)throw Error("No files were successfully downloaded");log(`Generating ZIP file with ${s} files`,"info");let m=await r.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}});if(0===m.size)throw Error("Generated ZIP file is empty");let y=document.createElement("a");y.href=URL.createObjectURL(m),y.download=`${t}.zip`,document.body.appendChild(y),y.click(),document.body.removeChild(y),URL.revokeObjectURL(y.href),log(`ZIP created successfully! Size: ${(m.size/1024/1024).toFixed(2)} MB`,"success")}catch(D){throw D}}downloadBtn.addEventListener("click",downloadContent),reloadBtn.addEventListener("click",()=>{DIR_DL_TOKEN=null,localStorage.removeItem("DIR_DL_TOKEN"),location.reload()});</script>